============================================================
WEB APPLICATION PENTESTING – PRACTICAL ATTACKER MINDSET GUIDE
============================================================
============================================================
1. SITUATIONAL AWARENESS & RECON
============================================================

1.1 Application Mapping
------------------------------------------------------------
What to do:
- Click every button, link, tab, modal
- Observe which actions trigger network requests
- Identify UI-only vs API-driven functionality

Practical:
- DevTools > Network > XHR/Fetch
- Reload page, interact slowly
- Write down every endpoint
- Replay requests manually

Mindset:
Anything reachable by the browser is reachable by the attacker.

------------------------------------------------------------
1.2 JavaScript and script execution Recon
------------------------------------------------------------
Why:
Frontend code leaks internal APIs, logic, and feature flags.

What to do:
- Download all JS files
- Search for:
  api/
  admin
  internal
  debug
  test
  v1 / v2
  TODO / FIXME

Attack:
- Call discovered endpoints directly
- Ignore frontend restrictions

============================================================
2. API ATTACK SURFACE
============================================================

2.1 Undocumented or Hidden APIs
------------------------------------------------------------
What:
APIs not intended for normal users.

Actions:
- Call endpoint without authentication
- Call with low-privileged user
- Change HTTP methods:
  GET / POST / PUT / DELETE

Example:
GET /api/user/123
PUT /api/user/123
DELETE /api/user/123

Observation:
Many APIs protect only one HTTP method.

------------------------------------------------------------
2.2 API Parameter Tampering
------------------------------------------------------------
What:
Backend trusts client-supplied parameters.

Try:
- Modify numeric IDs
- Change role=user → role=admin
- Remove parameters entirely
- Duplicate parameters
- Send arrays instead of strings

Look for:
- Silent acceptance
- Partial validation
- Logic bypass

------------------------------------------------------------
2.3 API File Access & Path Traversal
------------------------------------------------------------
Look for parameters:
file=
path=
template=
export=
document=
image=

Payloads to try:
../
../../../../etc/passwd
..%2f..%2f..%2fetc%2fpasswd
/proc/self/environ

Notes:
- Compare error messages
- Look for timing differences
- Partial reads are valuable

------------------------------------------------------------
2.4 API Redirect Manipulation
------------------------------------------------------------
Parameters:
redirect=
return=
next=
callback=
url=

Payloads:
https://evil.com
//evil.com
/\evil.com
https://app.com.evil.com

Check:
- Token leakage
- Cookie forwarding
- OAuth misuse

============================================================
3. AUTHENTICATION TESTING
============================================================

3.1 Login Logic Bypass
------------------------------------------------------------
Try:
- Empty password
- Missing password parameter
- Duplicate parameters
- JSON instead of form-data
- Change Content-Type

Example:
{
  "username": "admin"
}

Some backends accept partial objects.

------------------------------------------------------------
3.2 Brute Force & Lockout
------------------------------------------------------------
Steps:
- Perform 10–20 failed logins
- Observe CAPTCHA or lockout
- Change IP / User-Agent
- Test API vs UI

Common issue:
Lockout enforced only on frontend.

------------------------------------------------------------
3.3 Forgot Password Abuse
------------------------------------------------------------
Actions:
- Trigger multiple resets
- Compare valid vs invalid user responses
- Inspect reset emails

Look for:
- Reusable tokens
- Tokens that never expire
- Predictable token formats
- Tokens exposed in responses

Advanced:
- Use token after password change
- Reset while logged in as another user

============================================================
4. AUTHORIZATION & ACCESS CONTROL
============================================================

4.1 IDOR (Insecure Direct Object Reference)
------------------------------------------------------------
Test everywhere:
user_id
order_id
invoice_id
uuid

Actions:
- Increment / decrement IDs
- Swap IDs between users
- Test GET, POST, PUT, DELETE

If blocked:
- Try another endpoint
- Try another API version
- Try another HTTP method

------------------------------------------------------------
4.2 Mass Assignment
------------------------------------------------------------
Add unexpected fields:
isAdmin=true
role=admin
verified=true
balance=9999

Watch responses closely.

============================================================
5. REQUEST INTEGRITY & CSRF
============================================================

5.1 CSRF Token Testing
------------------------------------------------------------
- Remove token
- Empty token
- Old token
- Random token

Then:
- Replay from another origin
- Modify Origin / Referer

------------------------------------------------------------
5.2 Header Trust Issues
------------------------------------------------------------
Modify:
Origin
Referer
X-Forwarded-For
X-Real-IP

Test:
- Remove headers
- Spoof internal IPs
- Slight domain modifications

============================================================
6. INPUT HANDLING & INJECTION
============================================================

6.1 Context-Aware XSS
------------------------------------------------------------
Identify context:
- HTML body
- Attribute
- JavaScript
- JSON

Payload example:
"><svg/onload=alert(1)>

Observe encoding and execution.

------------------------------------------------------------
6.2 Server-Side Template Injection
------------------------------------------------------------
Payloads:
{{7*7}}
${7*7}
<%= 7*7 %>

If evaluated:
Proceed carefully.

------------------------------------------------------------
6.3 Command Injection (Blind)
------------------------------------------------------------
Payloads:
; sleep 5
&& ping
| whoami

Measure response timing.

============================================================
7. FILE HANDLING
============================================================

7.1 File Upload Abuse
------------------------------------------------------------
Try:
- Allowed file type
- Double extensions
- MIME manipulation
- Polyglot files

Check:
- Can uploaded files be accessed directly?

------------------------------------------------------------
7.2 File Download Abuse
------------------------------------------------------------
Example endpoint:
/download?file=invoice.pdf

Test:
- Path traversal
- Accessing other users' files

============================================================
8. BUSINESS LOGIC ATTACKS
============================================================

8.1 Workflow Bypass
------------------------------------------------------------
- Skip steps
- Reorder requests
- Replay final action

Example:
Pay → Confirm → Ship
Try Ship directly.

------------------------------------------------------------
8.2 Race Conditions
------------------------------------------------------------
Actions:
- Send concurrent requests
- Automate with tooling
- Watch for double execution

Common targets:
- Payments
- Coupons
- Password resets

============================================================
9. THE ATTACKER LOOP (MEMORIZE)
============================================================
For every request ask:
- Can I remove something?
- Can I change the user or ID?
- Can I repeat it fast?
- Can I send it earlier or later?
- Can I call it directly?
- Can I change HTTP method?
- Can I change request format?

============================================================
END OF GUIDE – PRACTICE RESPONSIBLY
============================================================
